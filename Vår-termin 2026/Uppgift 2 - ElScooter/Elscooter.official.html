<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="Elscooter.css">
    <title>VHDeS.se Official</title>
</head>
<body>
    <h1>Hyr en ElScooter, hos VHDes</h1>
    <h2>Välkommen, Tage!</h2>

    <p id="pris">En elscooter har ett startpris på 10 kr, och därefter kostar det 5 kr/minut</p>
    <p id="elscooterStatus" class="status">Ingen elscooter hyrd</p>
    <p id="kostnadText">Kostnad: 0 kr</p>

    <button id="hyrKnapp">Hyr elscooter</button>
    <button id="lamnaTillbakaKnapp">Lämna tillbaka</button>
    
    <div id="uthyrningsHistorik"></div>

    <script>
        const parametrar = new URLSearchParams(window.location.search);
        const anvandarnamn = parametrar.get("anvandarnamn");
        const hyrKnapp = document.getElementById("hyrKnapp");
        const lamnaTillbakaKnapp = document.getElementById("lamnaTillbakaKnapp");
        const elscooterStatus = document.getElementById("elscooterStatus");
        const uthyrningsHistorik = document.getElementById("uthyrningsHistorik");
        const kostnadText = document.getElementById("kostnadText");
        const prisPerMinut = 5;
        const startPris = 10;
        let kostnadsTimer = null;
        let totalBetalning = 0;
        let uthyrningsStartTid = null;
        let ObetaldaSkulder = 0;

        lamnaTillbakaKnapp.style.display = "none";

        hyrKnapp.addEventListener("click", function () {
            uthyrningsStartTid = new Date();

            elscooterStatus.textContent = "Elscooter är hyrd";
            elscooterStatus.classList.add("rented");

            hyrKnapp.disabled = true;
            lamnaTillbakaKnapp.style.display = "inline-block";

            kostnadText.innerText = "Kostnad just nu: " + startPris + " kr";
                kostnadsTimer = setInterval(function () {
                    const nu = new Date();
                    const minuter = Math.floor(
            (nu - uthyrningsStartTid) / 60000
        );
                    const kostnad = startPris + (minuter * prisPerMinut);
            kostnadText.innerText ="Kostnad just nu: " + kostnad + " kr";
            }, 60000);
        });

        lamnaTillbakaKnapp.addEventListener("click", function () {
            const uthyrningsSlutTid = new Date();
            const minuter = Math.floor(
            (uthyrningsSlutTid - uthyrningsStartTid) / 60000
        );
            const kostnadDennaGang = startPris + (minuter * prisPerMinut);
                totalBetalning = ObetaldaSkulder + kostnadDennaGang;
                ObetaldaSkulder = totalBetalning;

        uthyrningsHistorik.innerText =
        "Du hyrde elscootern i " + minuter +
        " minuter.\nStartavgift: " + startPris + " kr." +
        "\nDenna gång kostade det: " +
        kostnadDennaGang + " kr." +
        "\nTidigare skuld: " +
        (totalBetalning - kostnadDennaGang) + " kr." +
        "\nTotalt att betala: " +
        totalBetalning + " kr.";

        elscooterStatus.innerText = "Ingen elscooter hyrd";
        elscooterStatus.classList.remove("rented");
            hyrKnapp.disabled = false;
        lamnaTillbakaKnapp.style.display = "none";
        
            clearInterval(kostnadsTimer);
        kostnadText.innerText = "Kostnad: 0 kr";
        });
    </script>
</body>
</html>